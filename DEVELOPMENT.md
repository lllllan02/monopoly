# 大富翁（Monopoly）项目开发与管理文档

本文件定义了系统的整体架构及后台管理系统（Admin Portal）的功能需求，用于支持游戏内容的动态配置与扩展。

## 1. 系统架构概述
项目采用前后端分离架构，主要由以下三部分组成：
*   **游戏客户端 (Client):** 玩家交互界面，展示棋盘、角色动画、UI 操作。
*   **游戏服务端 (Game Server):** 处理游戏逻辑、房间管理、WebSocket 实时通信。
*   **后台管理系统 (Admin Portal):** 供管理员配置游戏内容、监控游戏状态及管理资源。

## 2. 后台管理模块需求

### 2.1 房产库管理 (Property Library)
建立独立的房产元数据仓库，实现房产资产与地图布局的解耦：
*   **房产定义:** 独立定义每一块土地的名称、颜色组、购买基础价格、房屋/旅馆造价。
*   **租金体系:** 配置基础租金及随等级（房屋数量）增长的租金倍率。
*   **资产复用:** 支持房产在不同章节、不同地图中被多次引用。支持全局修改房产属性后，所有关联地图自动同步。

### 2.2 棋盘/地图设计 (Map Design)
专注于地图的拓扑结构与逻辑编排，实现“插槽式”设计：
*   **布局编辑器:** 定义地图的形状（如经典正方形、自定义路径）及格子总数。
*   **插槽配置 (Slot Mapping):** 将格子与逻辑资源绑定。例如：
    *   格子 A -> 引用房产库中的 [南京路]
    *   格子 B -> 引用 [机会卡组]
    *   格子 C -> 逻辑类型 [起点]
*   **地图版本:** 支持保存多个地图模板（如第一章：新手村，第二章：繁华都市）。

### 2.3 命运与机会管理 (Card Management)
对“命运（Fate）”和“机会（Chance）”卡组的内容管理：
*   **卡片内容编辑:** 编辑卡片文案、描述、图标。
*   **效果逻辑配置:** 为每张卡片绑定预设的触发效果（如：获得/扣除现金、移动到指定格子、出狱许可、按房屋数量罚款等）。
*   **权重与概率:** 配置不同卡片在卡组中的出现频率。

### 2.4 骰子管理 (Dice Management)
*   **骰子参数配置:** 配置游戏默认使用的骰子数量及每个骰子的面数（D6, D12 等）。
*   **特殊骰子:** 支持配置具有特殊效果的骰子（如：仅奇数、点数翻倍、包含特殊图标等）。

### 2.5 形象与资源管理 (Asset Management)
*   **角色模型/头像:** 管理玩家可选的角色形象（3D 模型文件、2D 贴图）。
*   **场景资源:** 管理棋盘主题相关的天空盒、背景音乐、环境音效。
*   **动态加载:** 支持通过管理端上传资源，客户端实时/按需下载。

### 2.6 游戏参数全局配置
*   **初始资源设定:** 默认初始金额、经过起点的奖励金额。
*   **建设规则:** 同组土地未集齐是否允许盖楼（可选开关）、单块地最高建筑上限。
*   **配置覆盖:** 支持在特定地图或章节中覆盖全局房产价格或租金。

### 2.7 用户模式 (User Logic)
本着“一切从简”原则，不设立账号注册/登录系统：
*   **游客识别:** 采用浏览器 `localStorage` 存储生成的 UUID 作为唯一标识，实现无感登录。
*   **昵称制度:** 玩家在进入房间前自拟昵称。
*   **数据绑定:** 后端逻辑将 UUID 与游戏内的资产、房产及历史战绩进行绑定。
*   **活跃监控:** 管理端可以查看当前在线的游客玩家及所在房间。

### 2.8 特殊地块与效果引擎 (Future Expansion)
为支持多样化的特殊地块，系统需预留以下扩展接口：
*   **道具系统 (Item System):** 支持玩家持有并使用各种效果卡/道具。
*   **状态引擎 (State Engine):** 管理角色的特殊状态（如：住院中、入狱中、财神附身等）及其持续时间。
*   **全局事件广播:** 支持新闻中心等格子触发全图范围的数据修改逻辑（如地价、利息）。
*   **地块行为扩展:** 允许地块不仅绑定房产，还能绑定复杂的交互函数（如打开银行窗口、打开商店列表）。

## 3. 技术设计要点（参考）
*   **数据持久化:** 采用 JSON 文件存储，无需安装外部数据库。房产库、地图库及卡组配置以 `.json` 格式存储在服务端本地。
*   **配置下发:** 游戏开始时，服务端将当前房间选定的配置（地图插槽数据、房产详情、卡组等）下发给所有客户端。
*   **扩展性:** 逻辑效果采用插件化设计，方便管理端通过简单的条件组合配置复杂的卡片效果。
